Vou implementar um sistema de separação de schemas para garantir que os bancos de dados fiquem limpos e organizados, sem tabelas duplicadas desnecessariamente.

### A Solução: Separação Automática de Schemas

Hoje, o `prisma db push` envia todas as tabelas para todos os bancos. Vamos mudar isso para que:

1. **Banco Principal (CRM):** Receba apenas tabelas de administração (`CrmUser`, etc.).
2. **Bancos dos Clientes (Tenants):** Recebam apenas tabelas de negócio (`Lead`, `Campaign`, etc.).

### Passos da Implementação

1. **Criar Script de Separação (`scripts/split-schema.ts`)**:

   * Este script lerá o arquivo `prisma/schema.prisma` principal.

   * Ele gerará automaticamente dois arquivos temporários: `prisma/schema.crm.prisma` e `prisma/schema.tenant.prisma`.

   * A separação será feita baseada nos nomes dos modelos (ex: `CrmUser` vai para CRM, `Lead` vai para Tenant).

2. **Atualizar Scripts de Sincronização**:

   * Vou modificar o `src/actions/tenant-sync.ts` (sincronização manual) e o `scripts/sync-tenants.ts` (sincronização em massa) para usarem o schema específico:
     `npx prisma db push --schema=prisma/schema.tenant.prisma`

3. **Configurar Comandos no** **`package.json`**:

   * Adicionarei comandos para facilitar o deploy correto:

     * `db:push:crm`: Atualiza apenas o banco principal.

     * `db:push:tenant`: Atualiza bancos de clientes (para testes).

     * `db:split`: Roda a separação dos arquivos.

4. Crie os testes necessarios para garantir a implementacao.

### Benefícios

* **Zero Duplicação:** O banco do CRM não terá tabelas de leads vazias, e os bancos dos clientes não terão tabelas de usuários administrativos vazias.

* **Segurança:** Reduz o risco de expor estruturas de dados onde não deveriam existir.

* **Transparência:** O arquivo `prisma/schema.prisma` continua sendo o único lugar que você precisa editar. A separação acontece "nos bastidores" automaticamente.

### Como vai funcionar para você

Você continuará editando apenas o `prisma/schema.prisma` como faz hoje. Quando precisar atualizar o banco, usará os novos comandos ou a automação que já existe, mas agora ela será "inteligente" o suficiente para mandar cada tabela para seu lugar certo.

Vou começar criando o script de separação e ajustando as configurações.
