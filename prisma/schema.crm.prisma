// ⚠️ ARQUIVO GERADO AUTOMATICAMENTE - NÃO EDITE
// Fonte: prisma/schema.prisma
// Comando: npm run db:split

// Schema unificado - Contém modelos do CRM central e do tenant
// O banco central (crm) terá apenas crm_users
// Os bancos dos tenants terão leads, campaigns, campaign_messages

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "postgresql"
}

// ============================================
// TABELA CENTRAL: Operadores/Admins do CRM
// ============================================



enum UserRole {
  ADMIN  // Pode gerenciar usuários
  USER   // Acessa apenas seus dados
}

model CrmUser {
  id            String    @id @default(cuid())
  email         String    @unique
  password      String    // Hash bcrypt
  name          String
  role          UserRole  @default(USER)
  databaseUrl   String?   @map("database_url") // URL do banco do cliente
  createdAt     DateTime  @default(now()) @map("created_at")
  updatedAt     DateTime  @updatedAt @map("updated_at")
  
  // Configuração Evolution API
  evolutionInstance String? @map("evolution_instance")
  evolutionInstanceHash String? @map("evolution_instance_hash") // Hash SHA-256 para busca rápida
  evolutionApiKey   String? @map("evolution_api_key")
  evolutionPhone    String? @map("evolution_phone") // Número do WhatsApp conectado
  
  @@index([evolutionInstanceHash])
  @@map("crm_users")
}
